# Win32 API 기반 워드 제작 프로젝트

## 1. 프로젝트 개요
* **개발 기간**: 2025.04 (약 20일)
* **개발 환경**:
    * Language: C++
    * Framework: Win32 API
    * IDE: Visual Studio
* **목표**: Win32 제공 컴포넌트 없이 워드 프로그램의 UI 컴포넌트의 생성부터 이벤트 처리, 객체 렌더링까지의 전 과정을 로우레벨에서 이해하고 구현.

---

## 2. 주요 기술 및 구현 상세

### Win32 API 기반 이벤트 중심 프로그래밍
* **이벤트 기반 프로그래밍** : 윈도우 메시시 큐를 통해 들어오는 이벤트를 분석하고, 사용자의 입력에 반응하고 렌더링하는 객체를 직접 구축했습니다.

### 워드 객체 모델 구조 설계
워드 프로그램의 복잡한 데이터를 관리하기 위해 "페이지 > 문단 > 문자" 로 이어지는 계층적 구조를 설계했습니다.
각 구조체 끼리는 연결 리스트로 구조체 사이의 삽입과 삭제를 원할하도록 구현하였고, 부모 구조체는 자식 구조체 리스트의 첫번째 포인터를 참조하도록 설계하였습니다.
* **계층 구조체 정의**: 각 객체 간의 포함 관계와 좌표 정보를 구조체로 정의하여 데이터의 정밀한 관리가 가능하도록 했습니다.
* **객체 계층 구조**:

    * **WORDBOX**: 페이지 구조체
      * first_line: 첫번째 문단 구조체 포인터
      * pos_x, pos_y, size_x, size_y: 페이지 위치 및 크기
    * **LINELIST**: 문단 구조체
      * parent: 페이지 구조체 포인터
      * first_line: 첫번째 글자 구조체 포인터
      * line_size_x, line_size_y: 글자 구조체 크기
      * next, back: 다음, 이전 문단 구조체 포인터
    * **TCHARLIST**: 글자 구조체
      * parent: 문단 구조체 포인터
      * str: 표시할 문자
      * str_size_x, str_size_y, start_y: 글자 크기 및 시작 y 좌표

### 트리 구조를 활용한 Hit-Test 로직
수백 개 이상의 문자 객체 중 사용자가 클릭한 문자를 즉각적으로 찾아내기 위해 탐색 알고리즘을 최적화했습니다.
* **문제 예상**: 단순 선형 탐색(Linear Search) 시 객체 수가 많아질수록 클릭 반응 속도가 저하되는 성능 병목 현상 예상.
* **해결 방안**: 문서 구조를 트리 형태로 파악하고, 클릭 좌표가 포함된 범위를 `Page` -> `Paragraph` -> `Character` 순으로 좁혀가는 로직을 설계했습니다.

---

## 3. 배운점
객체 구조와 객체 간 관계를 직접 분석·설계하며 로우레벨 환경에서 컴포넌트를 구현하는 경험을 했습니다.
이 과정에서 이벤트 메시지로 전달되는 제한된 사용자 입력을 각 컴포넌트에 효율적으로 전달하기 위해, 트리 구조 기반의 부모–자식 간 데이터 전달 구조를 설계하고 고민하고 경험해보았습니다.

